# dns-threat-analysis-wireshark

# DNS Threat Report ‚Äì Simulated Threat Traffic  
**Author:** Samuel George  
**Date:** June 18, 2025  

---

## Objective

To simulate suspicious DNS activity ‚Äî including requests to fake domains and uncommon TLDs ‚Äî and analyze their resolution patterns and failure responses using Wireshark on a Windows machine.

---

## Simulated Queries & Results

### Queried Domains
| Domain               | Type         | Query Type | Response      | SOA Server               |
|----------------------|--------------|------------|---------------|--------------------------|
| fake123domain.com    | Fake Domain  | A / AAAA   | NXDOMAIN (3)  | a-gtld-servers.net       |
| zxcasdqwe321.net     | Random Domain| A / AAAA   | NXDOMAIN (3)  | a-gtld-servers.net       |
| 1.10.20.172.in-addr.arpa | PTR Lookup | PTR        | NXDOMAIN (3)  | prisoner.iana.org        |

---

### Detailed Wireshark Observations

| Frame | Type       | ID     | Description                                               |
|-------|------------|--------|-----------------------------------------------------------|
| 77    | Query      | 0x0002 | A query to `fake123domain.com`                            |
| 150   | Response   | 0x0002 | No such name, SOA = `a-gtld-servers.net`                  |
| 77    | Query      | 0x0003 | AAAA query to `fake123domain.com`                         |
| 77    | Query      | 0x0004 | A query to `fake123domain.com`                            |
| 150   | Response   | 0x0004 | No such name, SOA = `a-gtid-servers.net`                  |
| 77    | Query      | 0x0005 | AAAA query to `fake123domain.com`                         |
| 150   | Response   | 0x0003 | NXDOMAIN AAAA for `fake123domain.com`                     |
| 150   | Response   | 0x0005 | NXDOMAIN AAAA for `fake123domain.com`                     |
| 76    | Query      | 0x0002 | A query to `zxcasdqwe321.net`                             |
| 149   | Response   | 0x0002 | No such name, SOA = `a-gtld-servers.net`                  |
| 76    | Query      | 0x0003 | AAAA query to `zxcasdqwe321.net`                          |
| 76    | Query      | 0x0004 | A query to `zxcasdqwe321.net`                             |
| 149   | Response   | 0x0004 | NXDOMAIN A for `zxcasdqwe321.net`, SOA = `a-gtld-servers` |
| 84    | Query      | 0x0001 | PTR to `1.10.20.172.in-addr.arpa`                         |
| 161   | Response   | 0x0001 | NXDOMAIN PTR, SOA = `prisoner.iana.org`                   |

---

## Key Indicators

- All domains returned NXDOMAIN (rcode = 3) ‚Äî no IPs resolved.
- Multiple A and AAAA lookups were repeated ‚Äî typical of DGA tools.
- PTR lookup failed ‚Äî reverse DNS failed for private IP.

---

## Wireshark Filters Used

- `dns`
- `dns.flags.rcode == 3`
- `dns.qry.name contains ".xyz" or ".buzz"` (for TLD analysis)
- `ip.addr == 8.8.8.8` (to isolate Google DNS traffic)

---

## Conclusion

The failed A/AAAA/PTR queries and uncommon domain patterns simulate the kind of traffic generated by malware or beaconing tools. Monitoring NXDOMAIN response patterns, SOA origins, and query types is critical for early detection.

---
# DNS Threat Analysis with Wireshark

A simple but effective DNS threat hunting simulation using Wireshark on Windows. This project analyzes fake domain queries, uncommon TLD behavior, and DNS failure patterns often linked to malware or beaconing traffic.

## Tools Used

- Windows CMD (`nslookup`)
- Wireshark

## What Was Done

- Queried fake domains (`fake123domain.com`, `zxcasdqwe321.net`)
- Queried random reverse PTR (`1.10.20.172.in-addr.arpa`)
- Captured DNS traffic
- Applied filters in Wireshark:
  - `dns`
  - `dns.flags.rcode == 3`
  - `ip.addr == 8.8.8.8`
  - `dns.qry.name contains ".xyz"` (for uncommon TLDs)

## Key Findings

- Multiple A, AAAA, and PTR queries failed (NXDOMAIN)
- SOA servers like `a-gtld-servers.net` and `prisoner.iana.org` returned responses
- The pattern resembles Domain Generation Algorithms (DGAs) or beaconing

## Included Files

- `dns_analysis.pcapng` ‚Äì Wireshark packet capture
- `dns_threat_report.md` ‚Äì Analyst-style report (step-by-step)
- `README.md` ‚Äì You‚Äôre reading it

## Use Case

Great for beginners and junior SOC analysts to practice DNS anomaly detection and create detection logic.

---

## üìå Recommendations

Based on this DNS traffic simulation, the following steps are recommended for security teams and SOC environments:

1. **Enable DNS Logging at the Endpoint or Firewall Level**  
   Collect all DNS query logs and store them centrally for analysis.

2. **Monitor for Repeated NXDOMAIN Responses**  
   Track hosts generating a high number of failed lookups, especially to random-looking domains or uncommon TLDs.

3. **Blacklist Abused TLDs in Proxy/Firewall Settings**  
   Block or alert on requests to `.xyz`, `.buzz`, `.top`, `.tk`, and other high-risk TLDs known to be abused by malware.

4. **Correlate DNS with Process Activity**  
   Pair DNS logs with process creation logs (e.g., Sysmon) to identify suspicious applications making outbound queries.

5. **Use Threat Intelligence to Enrich DNS Queries**  
   Compare domain queries against known bad indicators (from feeds like AlienVault OTX, Abuse.ch, etc.).

6. **Set Up SIEM Rules for NXDOMAIN Bursts or DGA Behavior**  
   Use your SIEM (e.g., Splunk, QRadar) to trigger alerts when a host generates multiple failed queries in a short time.

7. **Perform Regular DNS Threat Simulations**  
   Keep testing your detection logic by simulating beaconing, DGA, and C2-like DNS traffic in a safe, controlled lab.

---

## üìÅ Files Included

- `dns_analysis.pcapng`: The full capture  
- `dns_threat_report.md`: This report  
- `README.md`: Project summary and setup  
